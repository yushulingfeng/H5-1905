var _ACT_=_ACT_||{};_ACT_.components=_ACT_.components||{},_ACT_.components["base/vendor-pc"]=webpackJsonp([4],{101:function(module,exports,__webpack_require__){var AnimateDialog=__webpack_require__(379),_ut=__webpack_require__(4),_v=__webpack_require__(6),_tpl=__webpack_require__(667),Dialog=AnimateDialog.extend({template:_tpl,config:function(data){_ut.extend(data,{width:520}),data.style={height:"auto","margin-top":"0",width:"number"==typeof data.width?data.width+"px":data.width,"margin-left":"0","z-index":10001,left:"50%",top:"50%"},this.__autoHeight(),this.__bindEscEvent(),this.supr(data),data.timeout&&this.$timeout(function(){this.onclose()}._$bind(this),data.timeout)},onok:function(){this.supr(),this.data.onok&&this.data.onok()},onclose:function(){this.supr(),this.data.onclose&&this.data.onclose()},cancel:function(){var c,_callback=this.data.oncancel;_callback&&(c=_callback()),!1!==c&&this.onclose()},__autoHeight:function(){var self=this,data=self.data;data.height&&(data.style.height=data.height),data.useTrans=!0,"ie"==nej.p._$KERNEL.browser&&nej.p._$KERNEL.version<=9&&self.$on("inject",function(){data.useTrans=!1,self.__calcH(),self.$on("refresh",function(){self.__calcH()}),self.$update()})},__calcH:function(){var rect,self=this,data=self.data,$mdialog=self.$refs.mdialog;$mdialog&&(rect=_ut.getOffset($mdialog),data.style["margin-top"]=-rect.height/2+"px",data.style["margin-left"]=-rect.width/2+"px")},__bindEscEvent:function(){function keydownCb(event){27==(event||window.event).keyCode&&(self.onclose(),self.$update(),_v._$delEvent(document,"keydown",keydownCb))}var self=this;_v._$addEvent(document,"keydown",keydownCb)}}).use("timeout");Dialog.directive("countdown",function(ele,val){if(val&&!isNaN(val)){val/=1;var timerId=setInterval(function(){!val&&!clearInterval(timerId)&&this.onclose(),ele.innerHTML=val--}._$bind(this),1e3)}}),module.exports=Dialog},103:function(module,exports,__webpack_require__){var _=__webpack_require__(4),Regular=__webpack_require__(13),tpl=__webpack_require__(677);module.exports=Regular.extend({template:tpl,config:function(){var data=this.data;_.extend(data,{}),this.supr()},ok:function(){this.$emit("ok")},cancel:function(){this.$emit("cancel")}})},104:function(module,exports,__webpack_require__){var Regular=__webpack_require__(13),_=__webpack_require__(4),tpl=__webpack_require__(683),icon=__webpack_require__(390);module.exports=Regular.extend({template:_.compressHtml(tpl),config:function(){this.supr();var data=this.data,bottom=0===data.bottom?0:data.bottom||15;_.extend(data,{style:{width:(data.width||270)+"px",fontSize:(data.size||14)+"px",fontWeight:data.weight||"normal",marginBottom:bottom+"px"}})}}).component("icon",icon)},14:function(module,exports,__webpack_require__){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _index=__webpack_require__(220);Object.defineProperty(exports,"GoodsCartModal",{enumerable:!0,get:function(){return _interopRequireDefault(_index).default}});var _actoinModule=__webpack_require__(219);Object.defineProperty(exports,"cartModule",{enumerable:!0,get:function(){return _interopRequireDefault(_actoinModule).default}});var _index2=__webpack_require__(604);Object.defineProperty(exports,"couponModule",{enumerable:!0,get:function(){return _interopRequireDefault(_index2).default}});var _index3=__webpack_require__(221);Object.defineProperty(exports,"favorModule",{enumerable:!0,get:function(){return _interopRequireDefault(_index3).default}});var _action=__webpack_require__(605);Object.defineProperty(exports,"actionModule",{enumerable:!0,get:function(){return _interopRequireDefault(_action).default}});var _index4=__webpack_require__(58);Object.defineProperty(exports,"login",{enumerable:!0,get:function(){return _interopRequireDefault(_index4).default}})},165:function(module,exports,__webpack_require__){var BaseComponent=__webpack_require__(17),_=__webpack_require__(4),tpl=__webpack_require__(675);module.exports=BaseComponent.extend({template:_.compressHtml(tpl),config:function(){this.supr();var data=this.data;_.extend(data,{})}})},166:function(module,exports,__webpack_require__){var _=__webpack_require__(4),Modal=(__webpack_require__(6),__webpack_require__(43)),tpl=__webpack_require__(676),Dialogs=__webpack_require__(74),AccountAjax=__webpack_require__(85),ursLogin=__webpack_require__(171),reminder=__webpack_require__(104),btn=(__webpack_require__(165),__webpack_require__(103)),phoneInput=__webpack_require__(169),error=__webpack_require__(167),linkText=__webpack_require__(168);module.exports=Modal.extend({config:function(){function refreshData(step){["reminder","error","btn","linkText"].forEach(function(cpt){data[cpt]=dataCenter[step][cpt]||""})}this.supr();var data=this.data;if(data.desc=data.desc||"",!data.code)return console.error("缺少必要的参数：code"),!1;var dataCenter={enterPhone:{reminder:{text:data.desc,size:15},error:{icon:!0,align:"left",width:269,margin:"-5px auto 10px"},btn:{hideCCBtn:!0,txtOk:"下一步"}},validatePhone:{reminder:{text:data.desc,bottom:0},linkText:{text:"上一步"}}};_.extend(data,{title:"提示",width:520,modalName:"m-bindphone m-bindaccount",content:_.compressHtml(tpl),step:"enterPhone",phone:"",isEnterprise:!!data.source,dataCenter:dataCenter,bindToken:"",ursLogin:{type:null,phoneNum:"",agentUrlParamStr:data.source?"source="+data.source:"",ursOptions:{regMbTxt:data.bindBtnText,smsBtnTxt:data.bindBtnText,mbBtnTxt:data.bindBtnText}},enterPhoneError:""}),refreshData(data.step),this.$watch("step",function(cur){refreshData(cur)})},init:function(data){switch(data.step){case"enterPhone":this.daEvent("填写","出现"),this.$emit("enterPhone","show");break;case"validatePhone":this.daEvent("验证","出现"),this.$emit("validatePhone","show")}this.supr()},onBtnOk:function(step){var data=this.data;if("enterPhone"===step){if(this.$emit("enterPhone","next"),!this.verifyPhoneFrontEnd())return;if(data.isEnterprise)return void this.verifyPhoneBackEnd();this.thirdpartyBindPhoneAjax()}},close:function(){switch(this.data.step){case"enterPhone":this.daEvent("填写","关闭"),this.$emit("enterPhone","close");break;case"validatePhone":this.daEvent("验证","关闭"),this.$emit("validatePhone","close")}this.supr()},verifyPhoneFrontEnd:function(){var result=this.$refs.phoneInput.$verifyPhone()||{};return!!result.pass||(this.data.enterPhoneError=result.desc,!1)},verifyPhoneBackEnd:function(){var data=this.data;AccountAjax.checkSource({phone:data.phone,source:data.source},this.verifyPhoneBackEndLoaded._$bind(this))},verifyPhoneBackEndLoaded:function(_json){var json=_json||{};200===json.retcode?this.showUrsForEnterprise(json.isUrsMobileUser):this.$update({enterPhoneError:json.retdesc||"验证手机号失败"})},showUrsForEnterprise:function(isUrsMobileUser){var data=this.data;this.daEvent("验证","出现"),data.step="validatePhone",data.ursLogin.type=isUrsMobileUser?1:2,data.ursLogin.phoneNum=data.phone,this.$update(),this.$emit("validatePhone","show")},phoneInputFocus:function(){this.data.enterPhoneError=""},validatePhonePrevStep:function(){var data=this.data;"validatePhone"===data.step&&(this.daEvent("填写","出现"),data.step="enterPhone",this.$emit("validatePhone","prevstep"))},thirdpartyBindPhoneAjax:function(){var data=this.data,params={phoneNum:data.phone};data.isEnterprise&&(params.source=data.source),AccountAjax.preBindAccount(params,this.onPreBindAccountLoaded._$bind(this))},onPreBindAccountLoaded:function(_json){var json=_json||{},data=this.data,result=json.result||{};200===json.retcode?(this.daEvent("验证","出现"),data.step="validatePhone",data.bindToken=result.bindToken,data.ursLogin.type=result.isUrsMobileUser?1:2,data.ursLogin.phoneNum=data.phone,this.$emit("validatePhone","show")):this.bindAccountErrorModal(json),this.$update()},onPhoneLoginSuccess:function(){var data=this.data;this.daEvent("验证","立即绑定"),data.isEnterprise?this.$emit("enterpriseSuccess"):(this.$emit("validatePhone","bind"),AccountAjax.bindAccountForBusi(data.bindToken,function(json){var result=json.result||{};if(200!==json.retcode)return void this.bindAccountErrorModal(json);this.bindAccountSuccess(result)}._$bind(this)))},bindAccountErrorModal:function(json){this.destroy(),Dialogs.twoLineDialog({icon:"fail",text1:"绑定失败",text2:json.retdesc||"",okBtnText:"我知道了",hideCCBtn:!0,marginLeft:15,clazz:"m-bindAccountHint"})},bindAccountSuccess:function(){"function"==typeof window._$refreshTopbar&&window._$refreshTopbar(),this.$emit("success"),this.destroy()},daEvent:function(action,label){var data=this.data;_.daEvent("个人中心",data.code+"-"+action+"手机号",label,{content:data.desc})}}).component("ursLogin",ursLogin).component("reminder",reminder).component("btn",btn).component("phoneInput",phoneInput).component("error",error).component("linkText",linkText)},167:function(module,exports,__webpack_require__){var Regular=__webpack_require__(13),_=__webpack_require__(4),tpl=__webpack_require__(679);module.exports=Regular.extend({template:_.compressHtml(tpl),config:function(data){this.supr();var style={};data.width&&(style.width=data.width+"px"),data.align&&(style.textAlign=data.align),data.margin&&(style.margin=data.margin),_.extend(data,{style:style}),this.$watch("text",function(val){data.style.visibility=val?"visible":"hidden"})}})},168:function(module,exports,__webpack_require__){var Regular=__webpack_require__(13),_=__webpack_require__(4),tpl=__webpack_require__(681);module.exports=Regular.extend({template:_.compressHtml(tpl),config:function(){this.supr()},textClick:function(){this.$emit("hit")}})},169:function(module,exports,__webpack_require__){var BaseComponent=__webpack_require__(17),_=__webpack_require__(4),tpl=__webpack_require__(682);module.exports=BaseComponent.extend({template:tpl,config:function(data){this.supr(data),_.extend(data,{error:!1})},focus:function(){this.$emit("focus",this.data.phone)},$verifyPhone:function(){var data=this.data,reg=/(^1[3-9]\d{9}$)|(^1[3-9][0-9]{1}[*]{4}[0-9]{4}$)/g,phone=data.phone;return phone?reg.test(phone)?{pass:!0,desc:"验证通过"}:{pass:!1,desc:"请输入正确手机号"}:{pass:!1,desc:"请输入手机号"}}})},171:function(module,exports,__webpack_require__){var _=__webpack_require__(4),_e=__webpack_require__(3),BaseComponent=(__webpack_require__(6),__webpack_require__(17)),tpl=__webpack_require__(689),_tag=__webpack_require__(71),originUrl=window.location.protocol+"//"+window.location.host,loginAgentUrl=location.protocol+"//www.kaola.com/urs/163redirect.html?target="+encodeURIComponent(originUrl+"/agent/loginAgent.htm?from=iframeLogin");module.exports=BaseComponent.extend({template:tpl,name:"ursLogin",baseURSConfig:{version:3,newCDN:1,cookieDomain:"kaola.com",regCookieDomain:"kaola.com",product:"kaola",promark:"nFcgaHs",productkey:"0a843196d8364f168c165a319ea86eac",domains:"kaola.com.hk",isHttps:1,host:"www.kaola.com",includeBox:"ursincludebox",noqr:1,swidth:"270",noMobileReg:1,needUnLogin:1,defaultUnLogin:1,unLoginText:"10天免登录",mobileUnLoginTimeTxt:"10天免登录",mobileUnLoginTime:10,mobileDefaultUnLogin:1,single:1,errMode:1,cssDomain:"//mm.bst.126.net/",cssFiles:"res/csslib/urslogin1.css",style:".u-tab,.m-cnt .m-unlogin,.regManager .fur-change-email{display:none;}#cnt-box{padding-top:30px;}.m-cnt .regManager{padding-top:0px;}",mode:"embed",customStyles:{},capPadding:0,capBarHeight:40},ursConfigMap:{1:{page:"login",needMobileLogin:1,mobileFirst:1,smsLoginFirst:1,smsBtnTxt:"登 录",mbBtnTxt:"登 录"},0:{page:"login",placeholder:{account:"网易邮箱帐号",pwd:"密码"}},2:{page:"register",regSucCount:3,needMobileReg:1,mobileFirst:1,regMbTxt:"注 册",mbNoPwd:1}},ursHeightMap:[230,254,356],config:function(data){this.supr(data);var config=_.extend(_.extend(data.ursOptions||{},this.ursConfigMap[data.type||0]),this.baseURSConfig);if(config.preFilledMobileReg=config.preFilledMobile=data.phoneNum||"",config.style+=data.css,data.currentConfig=config,data.currentConfig.logincb=this.loginCb._$bind(this),data.currentConfig.regcb=this.regCb._$bind(this),data.currentConfig.statecb=this.stateCb._$bind(this),data.height=this.ursHeightMap[data.type||0],setTimeout(function(){this.initURS()}._$bind(this),10),this.loginAgentIframe=_e._$get("loginIframeAgent"),!this.loginAgentIframe){var iframe=this.getElement('<iframe id="loginIframeAgent" name="loginIframeAgent" frameborder="0" width="0" height="0" src=""/>');document.body.insertBefore(iframe,_e._$getChildren(document.body)[0]),this.loginAgentIframe=iframe}window.loginCallback=this.iframeLoginCb._$bind(this)},initURS:function(){window.URS?this.newURS():_tag._$queueScript(["https://urswebzj.nosdn.127.net/webzj_cdn101/message.js"],{onload:function(){this.newURS()}._$bind(this),onerror:function(){window._dapush&&window._dapush("_trackEvent","前端报错信息","PC","URS-js弹窗加载失败")}})},newURS:function(){this.URSWidget=new URS(this.data.currentConfig),this.URSWidget.showIframe()},iframeLoginCb:function(){this.$emit("successCb",this.data.username||"")},loginCb:function(username){this.loginIframe(username)},regCb:function(username){this.loginIframe(username)},loginIframe:function(username){var data=this.data;data.username=username,this.loginAgentIframe.src=loginAgentUrl+(data.agentUrlParamStr?"&"+data.agentUrlParamStr:"")},stateCb:function(){},destroy:function(option){this.URSWidget.closeIframe(),this.supr(option)},getElement:function(content){var _node=document.createElement("div");return _node.innerHTML=content,_e._$getChildren(_node)[0]}})},211:function(module,exports,__webpack_require__){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _assign=__webpack_require__(8),_assign2=_interopRequireDefault(_assign);__webpack_require__(540);var _index=__webpack_require__(133),_index2=_interopRequireDefault(_index),_view=__webpack_require__(705),_view2=_interopRequireDefault(_view),Confirm=_index2.default.extend({config:function(){(0,_assign2.default)(this.data,{contentTemplate:_view2.default}),this.supr(this.data)}});exports.default=Confirm},219:function(module,exports,__webpack_require__){Object.defineProperty(exports,"__esModule",{value:!0});var _index=__webpack_require__(220),_index2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_index),cartActionModule={domain:1==window._ACT_.requestSource?"m.kaola.com":"www.kaola.com",$addCart:function(options){var _options$goodsInfo=options.goodsInfo,goodsId=_options$goodsInfo.goodsId;if(1!=_options$goodsInfo.isShowCart)return void this.doJumpDetailLink(goodsId);new _index2.default({data:{goodsId:goodsId,addSuccessCallback:options.cbFunc}})},doJumpDetailLink:function(goodsId){void 0===this.domain&&(this.domain=1==window._ACT_.requestSource?"m.kaola.com":"www.kaola.com"),location.href=location.protocol+"//"+this.domain+"/product/"+goodsId+".html"}};exports.default=cartActionModule},220:function(module,exports,__webpack_require__){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _assign=__webpack_require__(8),_assign2=_interopRequireDefault(_assign);__webpack_require__(555);var _view=__webpack_require__(719),_view2=_interopRequireDefault(_view),_modal=__webpack_require__(133),_modal2=_interopRequireDefault(_modal),_tools=__webpack_require__(1),_index=__webpack_require__(58),_index2=_interopRequireDefault(_index),_index3=__webpack_require__(10),_constant=__webpack_require__(11),CONST=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_constant),GoodsCartModal=_modal2.default.extend({config:function(data){this.data=(0,_assign2.default)(data,{title:"加入购物车",hasConfirm:!0,hasCancel:!1,hasFooter:!1,hasHeader:!0,hasCloseBtn:!0,contentTemplate:_view2.default,width:600,goods:null,getGoodsLoading:"",addCartLoading:!1,selectedResult:[],selectedIndexResult:[],disablePropertyIndexMapping:[],matchSkuTotalStore:0,matchSkuPrice:null,selectedPropertiesInfo:{selectedPropertyNames:[],noSelectedPropertyNames:[],selectedPropertyDetail:[]},isMultiSku:!1,addCartSuccess:!1,errMsg:"",getGoodsDetailErr:""}),this.getGoodsDetailURL="/pages/cart/ajax/querySkuById.html",this.addGoodsCartURL="//"+CONST.DOMAIN_TRADE+"/cart/addCartItem.html?_s="+ +new Date,this.innerSource=this.getInnerSource()},init:function(){this.data.goodsId&&this.getGoodsDetail(),this.$inject(document.body)},getInnerSource:function(){var ref=(document.referrer||"").toLowerCase(),search=window.location.search.replace("?","");return/\/\/[^\/]+?\/search\//.test(ref)?"SEARCH":"specialtopic"==_tools.util.query2obj(search).from?"SPETOPIC":"DETAIL"},getGoodsDetail:function(){var _this=this,that=this;return this.data.getGoodsLoading="loading",this.data.errMsg="",this.data.getGoodsDetailErr="",this.data.goods=null,this.$update(),_tools.fetchUtil.$request(this.getGoodsDetailURL+"?goodsId="+this.data.goodsId,{method:"GET"}).then(function(res){if(that.data.getGoodsLoading="",res.success&&200==res.code){if(that.data.goods=res.data,that.data.isMultiSku=that.data.goods.skuInfoList&&that.data.goods.skuInfoList.length>1,that.data.matchSkuTotalStore=that.getTotalStoreByskuInfoList(_this.getMatchSkus()),that.data.disablePropertyIndexMapping=that.getDisabledPropertyIndexMapping(),that.data.selectedPropertiesInfo=that.getSelectedPropertyNames(),that.skuCounterNum=1,0===that.data.matchSkuTotalStore)return that.data.getGoodsDetailErr="该商品库存不足，无法加入购物车",setTimeout(function(){that.onClose()},2e3),void that.$update();if(!that.data.isMultiSku){var selectedSku=_this.getMatchSkus();selectedSku=selectedSku[0],selectedSku&&void 0!==selectedSku.minBuyNum&&!isNaN(selectedSku.minBuyNum)&&selectedSku.minBuyNum>0&&(that.skuCounterNum=selectedSku.minBuyNum),that.confirmAddCart()}}else that.data.getGoodsDetailErr="获取商品信息失败"+(res.desc?"："+res.desc:""),setTimeout(function(){that.onClose()},2e3);that.$update()})},addGoodsToCookie:function(goods){var cartCookie=decodeURIComponent(_tools.cookie._$cookie("NTES_KAOLA_CART_NEW")),now=Date.now(),cartGoodsArr=[];if(cartCookie){var index=-1;cartGoodsArr=cartCookie.split("|");for(var i=0,l=cartGoodsArr.length;i<l;i++)if(cartGoodsArr[i]=cartGoodsArr[i].split("_")||[],cartGoodsArr[i].filter(function(item){return!!item}).length==cartGoodsArr[i].length){if(cartGoodsArr[i].length<6){var goodsId=cartGoodsArr[i][0],skuId=cartGoodsArr[i][3];goods.goodsId==goodsId&&goods.skuId==skuId&&(cartGoodsArr[i][1]=parseInt(cartGoodsArr[i][1])+parseInt(goods.count),cartGoodsArr[i][4]=now,index=i)}}else cartGoodsArr[i]=[];-1===index&&cartGoodsArr.push([goods.goodsId,goods.count,goods.source,goods.skuId,now])}else cartGoodsArr=[[goods.goodsId,goods.count,goods.source,goods.skuId,now]];var goodsCookieList=[];cartGoodsArr.forEach(function(cartGoods){cartGoods&&cartGoods.length&&goodsCookieList.push(cartGoods.join("_"))});var cook={value:encodeURIComponent(goodsCookieList.join("|")),path:"/",domain:"kaola.com",expires:365};_tools.cookie._$cookie("NTES_KAOLA_CART_NEW",cook)},confirmAddCart:function(){var that=this;this.data.addCartLoading||this.validate()&&_index2.default.isLogin(function(loginState){var selectedSkus=that.getMatchSkus(),skuId="",goodsInfo={};selectedSkus&&selectedSkus.length&&(skuId=""+selectedSkus[0].skuInfo.skuId,goodsInfo={comboId:" ",innerSource:""+(that.innerSource||"OTHER"),goodsList:[{goodsId:that.data.goodsId,skuId:skuId,count:that.skuCounterNum||0,isHuanGou:0,selected:1}]},that.data.addCartLoading=!0,that.sendAddCartRequest(goodsInfo).then(function(res){that.data.addCartLoading=!1,res.success&&200==res.code?(that.data.addCartSuccess=!0,setTimeout(function(){"function"==typeof that.data.addSuccessCallback&&that.data.addSuccessCallback(),that.onClose()},2500),res.data&&res.data.cartGoodsNum&&_tools.eventEmitter.$emit("updateCartNum",res.data.cartGoodsNum)):that.data.isMultiSku?that.showErrMsg("操作失败，请重试"):that.data.errMsg="操作失败，请重试",that.$update()}).catch(function(){that.data.addCartLoading=!1,that.data.errMsg="操作失败，请重试",that.$update()}),that.$update())})},sendAddCartRequest:function(){var goodsInfo=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _tools.fetchUtil.$request(""+this.addGoodsCartURL,{method:"POST",body:goodsInfo})},validate:function(){var that=this,selectedSku=void 0;if(!that.data.goods)return!1;var selectedPropertiesInfo=that.data.selectedPropertiesInfo;return selectedPropertiesInfo.noSelectedPropertyNames&&selectedPropertiesInfo.noSelectedPropertyNames.length?(that.showErrMsg("请选择："+selectedPropertiesInfo.noSelectedPropertyNames.join("、")),!1):!(!(selectedSku=this.getMatchSkus())||!selectedSku.length)&&(selectedSku=selectedSku[0],0==selectedSku.skuStore.currentStore||this.skuCounterNum>selectedSku.skuStore.currentStore?(that.showErrMsg("库存不足"),!1):this.skuCounterNum<=0?(that.showErrMsg("请选择购买数量"),!1):!(this.skuCounterNum<selectedSku.minBuyNum)||(that.showErrMsg("当前商品至少需要购买"+selectedSku.minBuyNum+"件"),!1))},showErrMsg:function(errMsg){var that=this;this.data.errMsg=errMsg,setTimeout(function(){that.data.errMsg="",that.$update()},2e3)},selectSkuProperty:function(propertyIndex,itemIndex,item){var selectedResult=this.data.selectedResult,selectedIndexResult=this.data.selectedIndexResult;this.data.disablePropertyIndexMapping[propertyIndex][itemIndex]||(selectedIndexResult[propertyIndex]===itemIndex?(selectedResult[propertyIndex]="",selectedIndexResult[propertyIndex]=-1):(selectedResult[propertyIndex]=item.propertyValueId,selectedIndexResult[propertyIndex]=itemIndex),this.data.matchSkuTotalStore=this.getTotalStoreByskuInfoList(this.getMatchSkus()),this.data.disablePropertyIndexMapping=this.getDisabledPropertyIndexMapping(),this.data.selectedPropertiesInfo=this.getSelectedPropertyNames(),this.data.selectedPropertiesInfo.noSelectedPropertyNames&&this.data.selectedPropertiesInfo.noSelectedPropertyNames.length?this.data.matchSkuPrice=null:this.data.matchSkuPrice=this.getMatchSkus()[0].skuStore.currentPrice,this.$update())},getSelectedPropertyNames:function(){var skuProperties=this.data.goods.skuProperties,_data=this.data,selectedResult=_data.selectedResult,selectedIndexResult=_data.selectedIndexResult,result={};if(this.data.isMultiSku){var selectedPropertyNames=[],selectedPropertyDetail=[],noSelectedPropertyNames=[];skuProperties.forEach(function(property,propertyIndex){selectedResult[propertyIndex]?(selectedPropertyNames.push(property.propertyName),selectedPropertyDetail.push(property.skuPropertyValueList[selectedIndexResult[propertyIndex]].propertyValue)):noSelectedPropertyNames.push(property.propertyName)}),result={selectedPropertyNames:selectedPropertyNames,noSelectedPropertyNames:noSelectedPropertyNames,selectedPropertyDetail:selectedPropertyDetail}}return result},getDisabledPropertyIndexMapping:function(){var that=this,skuProperties=this.data.goods.skuProperties,selectedResult=this.data.selectedResult,result=[];return skuProperties&&skuProperties.forEach(function(property,propertyIndex){result[propertyIndex]||(result[propertyIndex]=[]),property.skuPropertyValueList.forEach(function(val,valIndex){var propertiesValArr=selectedResult.slice();propertiesValArr[propertyIndex]=val.propertyValueId;var matchSkus=that.getSkuByProperties(propertiesValArr),matchSkusTotalStore=that.getTotalStoreByskuInfoList(matchSkus);result[propertyIndex][valIndex]=0===matchSkusTotalStore})}),result},getTotalStoreByskuInfoList:function(){var skuInfoList=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],totalStore=0;return skuInfoList.forEach(function(sku){totalStore+=sku.skuStore.currentStore}),totalStore},getSkuByProperties:function(properties){var skuInfoList=this.data.goods.skuInfoList||[],result=[];return properties=properties||[],skuInfoList.forEach(function(sku){for(var property,isMatch=!0,i=0;i<properties.length&&(property=properties[i],property&&(isMatch=isMatch&&-1!==sku.skuInfo.skuPropervalueIdList.indexOf(property)),isMatch);i++);isMatch&&result.push(sku)}),result},getMatchSkus:function(){var data=this.data,selectedResult=(data.goods,data.selectedResult),result=[];return data.isMultiSku?result=this.getSkuByProperties(selectedResult):result.push(this.data.goods.skuInfoList[0]),result},counterChange:function(counterInfo){this.skuCounterNum=counterInfo.num}});GoodsCartModal.component("Counter",_index3.Counter),exports.default=GoodsCartModal},221:function(module,exports,__webpack_require__){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _base=__webpack_require__(139),_base2=_interopRequireDefault(_base),_index=__webpack_require__(58),_index2=_interopRequireDefault(_index),FavorModule=_base2.default.extend({toLogin:function(cbFunc){_index2.default.toLogin(cbFunc)},showTip:function(){}}),favorModule=new FavorModule;exports.default=favorModule},302:function(module,exports,__webpack_require__){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _helloworld=__webpack_require__(590);Object.defineProperty(exports,"test",{enumerable:!0,get:function(){return _interopRequireDefault(_helloworld).default}})},305:function(module,exports,__webpack_require__){__webpack_require__(211)},379:function(module,exports,__webpack_require__){var BaseComponent=__webpack_require__(17),_ut=__webpack_require__(4),_e=__webpack_require__(3),Dialog=BaseComponent.extend({config:function(data){_ut.extend(data,{active:!0}),this.supr(data)},onok:function(){this.data.active=!1,setTimeout(function(){this.destroy()}._$bind(this),350),this.$update()},onclose:function(){this.data.active=!1,setTimeout(function(){this.destroy()}._$bind(this),350),this.$update()}});Dialog.directive("animate",function(ele){_e._$addClassName(ele,"iDialogAnimate5"),_e._$addClassName(ele,"iDialogAniCore"),this.$watch("active",function(val){val?setTimeout(function(){_e._$delClassName(ele,"iDialogAnimate5")},100):_e._$addClassName(ele,"iDialogAnimate5")})}),module.exports=Dialog},390:function(module,exports,__webpack_require__){var Regular=__webpack_require__(13),_=__webpack_require__(4),tpl=__webpack_require__(680),d={};d.icons={alert:"icon-emotion",forbid:"icon-error",success:"icon-check-circle",fail:"icon-close-circle"},d.color={green:"succ",red:"fail"},module.exports=Regular.extend({template:tpl,config:function(){var data=this.data,type=data.type,color=data.color;type&&(color||(color="success"===type?"green":"red"),_.extend(data,{color:d.color[color],icon:d.icons[type]}),this.supr())}})},540:function(module,exports){},555:function(module,exports){},58:function(module,exports,__webpack_require__){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _util=__webpack_require__(34),_util2=_interopRequireDefault(_util);(0,_interopRequireDefault(__webpack_require__(137)).default)("pc"),exports.default=_util2.default},590:function(module,exports){},604:function(module,exports,__webpack_require__){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _base=__webpack_require__(138),_base2=_interopRequireDefault(_base),_index=__webpack_require__(58),_index2=_interopRequireDefault(_index),_index3=__webpack_require__(211),_index4=_interopRequireDefault(_index3),_bindPhone=__webpack_require__(166),_bindPhone2=_interopRequireDefault(_bindPhone),CouponExchange=_base2.default.extend({cbGetCoupon:function(cbdata,options){var code=cbdata.code;if(401==code)return void _index2.default.toLogin(this.loginCbFunc.bind(this,options));if(-44==code)return void this.jumpToPhoneBindPage(options);var content=void 0;options.hasCouponLink&&-12==code||(content=cbdata.success&&cbdata.data&&cbdata.data.couponAmount?"<p>"+cbdata.data.couponAmount+'元优惠券领取成功</p><a href="//www.kaola.com/personal/my_coupon.html" class="link">查看我的优惠券</a>':"<p>"+(cbdata.desc||"领取失败")+'</p><a href="//www.kaola.com/personal/my_coupon.html" class="link">查看我的优惠券</a>',new _index4.default({data:{content:content}}).$inject(document.body)),options&&options.cbGetCoupon&&options.cbGetCoupon(cbdata)},jumpToPhoneBindPage:function(){var _this=this,options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};options.redeemCode&&new _bindPhone2.default({data:{code:"04P",desc:"请绑定手机号",bindBtnText:"立即绑定"}}).$on("success",function(){_this.$onGetCoupon(options)})}}),getCoupon=new CouponExchange;exports.default=getCoupon},605:function(module,exports,__webpack_require__){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _base=__webpack_require__(140),_base2=_interopRequireDefault(_base),_index=__webpack_require__(221),_index2=_interopRequireDefault(_index),_actoinModule=__webpack_require__(219),_actoinModule2=_interopRequireDefault(_actoinModule),AcitonModule=_base2.default.extend({doFavor:function(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_index2.default.$doFavor(options)},addCart:function(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_actoinModule2.default.$addCart(options)}}),acitonModule=new AcitonModule;exports.default=acitonModule},667:function(module,exports){module.exports='<div ref="mdialog" class="m-dialog {clazz}" animate r-class="{{\'align\':useTrans}}" r-style="{style}"> <div class="head"> <h1>{title || \'提示\'}<span class="subtitle">{subTitle || \'\'}</span></h1> </div> <a class="close" hidefocus="true" href="javascript:;" on-click="{this.onclose()}"></a> <div class="body"> <div class="message"> {#include msg} </div> {#if hideOkBtn != true} <a href="javascript:;" class="btn u-btn u-btn-ok u-btn-medium" on-click="{this.onok()}"> <span r-html="{txtOk || \'确认\'}"></span> </a> {/if} {#if hideCCBtn != true} <a href="javascript:;" class="btn u-btn u-btn-cancel u-btn-medium" on-click="{this.cancel()}" r-html="{txtCC || \'取消\'}"></a> {/if} </div>\n</div>\n<div class="u-mask" style="z-index:10000;"></div>'},675:function(module,exports){module.exports='<ul class="bindEach f-cb"> {#list accountInfo as account} <li class="info"> <img class="avatar" src="{account.avatar|imgThumbnailUrl:72,72,95}" alt="头像"> <p class="nickname"><b class="account-ico-small account-ico-small-{account.type}"></b>{account.nickname}</p> </li> {#if account_index===0} <li class="arrow"></li> {/if} {/list}\n</ul>'},676:function(module,exports){module.exports="{#if step==='enterPhone'} <reminder text={reminder.text} size={reminder.size}></reminder>\n<phoneInput ref=\"phoneInput\" phone={phone} error={ !!enterPhoneError } on-focus={this.phoneInputFocus($event)}></phoneInput>\n<error text={enterPhoneError} icon={error.icon} align={error.align} width={error.width} margin={error.margin}></error>\n<btn hideCCBtn={btn.hideCCBtn} txtOk={btn.txtOk} on-ok={this.onBtnOk(step)}></btn> {#elseif step==='validatePhone'} <reminder text={reminder.text} bottom={reminder.bottom}></reminder>\n<ursLogin type={ursLogin.type} phoneNum={ursLogin.phoneNum} ursOptions={ursLogin.ursOptions} agentUrlParamStr={ursLogin.agentUrlParamStr} on-successCb={this.onPhoneLoginSuccess($event)}></ursLogin>\n<linkText text={linkText.text} on-hit={this.validatePhonePrevStep()}></linkText> {/if}"},677:function(module,exports){module.exports='<div class="m-modal-footer"> {#if hideOkBtn != true} <a href="javascript:;" class="btn u-btn u-btn-ok u-btn-medium {okClazz || \'\'}" on-click="{this.ok()}" r-html="{txtOk || \'确认\'}"></a> {/if} {#if hideCCBtn != true} <a href="javascript:;" class="btn u-btn u-btn-cancel u-btn-medium {cancelClazz || \'\'}" on-click="{this.cancel()}" r-html="{txtCC || \'取消\'}"></a> {/if}\n</div>'},679:function(module,exports){module.exports="<p class='errorText' r-style={style}>{#if icon}<b class='iconfont icon-error'></b>{/if}{text}</p>"},680:function(module,exports){module.exports="<i class='iconfont {icon} {color}'></i>"},681:function(module,exports){module.exports="<p class='linkText'><a href='javascript:;' on-click={this.textClick($event)}>{text}</a></p>"},682:function(module,exports){module.exports='<div class="phoneInputWrap"> <input type="text" r-class={{\'f-error\':error}} r-model={phone|integer} placeholder="请输入手机号" maxlength="11" on-focus={this.focus($event)}> <b class=\'ico iconfont icon-phone1\'></b>\n</div>'},683:function(module,exports){module.exports="<p class='reminder m-dialog-result' r-style={style}> {#if !!icon} <icon type={icon}></icon> {/if} <span r-html={text}></span>\n</p>"},689:function(module,exports){module.exports='<div class="ph-loading" id="ursincludebox" style="height:{height}px;position:relative;top:-30px;"></div>'},705:function(module,exports){module.exports='<div class="m-confirm"> <div class="m-content"> {#inc content} </div>\n</div>'},719:function(module,exports){module.exports='<div class="pc-goodcart"> {#if addCartSuccess} <p class="cart-msg cart-msg_success">恭喜，商品已成功添加到购物车中</p> {#elseif getGoodsLoading === \'loading\' || (addCartLoading && !isMultiSku)} <p class="cart-msg">正在处理中...</p> {#elseif getGoodsDetailErr} <p class="cart-msg">{getGoodsDetailErr}</p> {#elseif goods && isMultiSku} <div class="cart-pro"> <div class="cart-pro-img"> <img src="{goods.imageUrl|fixProtocol}" /> </div> <div class="cart-pro-content"> <h6 class="cart-pro-info cart-pro-title">{goods.title}</h6> <p class="cart-pro-info cart-pro-price"> <span>￥{matchSkuPrice || goods.currentPrice}</span> {#if matchSkuTotalStore <= 0} (库存不足) {#else} (库存充足) {/if} </p> {#if isMultiSku} <p class="cart-pro-info cart-pro-memo"> {#if selectedPropertiesInfo.noSelectedPropertyNames && selectedPropertiesInfo.noSelectedPropertyNames.length} <span>请选择：{selectedPropertiesInfo.noSelectedPropertyNames.join(\'、\')}</span> {#else} <span>已选择：{selectedPropertiesInfo.selectedPropertyDetail.join(\'、\')}</span> {/if} </p> {/if} </div> </div> <div class="cart-sku"> {#if isMultiSku} <div class="cart-sku-items"> {#list goods.skuProperties as skuProperty} <div class="cart-sku-item"> <span class="cart-sku-name">{skuProperty.propertyName}</span> <ul class="cart-sku-options"> {#list skuProperty.skuPropertyValueList as item} {#if !disablePropertyIndexMapping[skuProperty_index][item_index]} <li on-click={this.selectSkuProperty(skuProperty_index, item_index, item)} r-class={{ "has-img": !!item.imageUrl, "active": selectedIndexResult[skuProperty_index] == item_index, "disabled": !!disablePropertyIndexMapping[skuProperty_index][item_index] }} title="{item.propertyValue}" data-valid="{item.propertyValueId}" > {#if item.imageUrl} <img class="cart-sku-img" src="{(item.imageUrl)|fixProtocol}" alt="{item.propertyValue}" /> {#else} <span>{item.propertyValue}</span> {/if} </li> {/if} {/list} </ul> </div> {/list} </div> {/if} <div class="cart-sku-item"> <span class="cart-sku-name">数量</span> <Counter num={matchSkuTotalStore <= 0 ? 0 : 1} disable={matchSkuTotalStore <= 0} lowerLimit={matchSkuTotalStore <= 0 ? 0 : 1} upperLimit={matchSkuTotalStore} on-change={this.counterChange($event)} /> </div> </div> <div class="cart-footer"> <a on-click={this.confirmAddCart()} href="javascript:;" class="cart-confirm-btn"> {#if addCartLoading} <span>处理中..</span> {#else} <span>确定</span> {/if} </a> <span class="cart-err">{errMsg}</span> </div> {#elseif errMsg} <p class="cart-msg">{errMsg}</p> {/if}\n</div>'},74:function(module,exports,__webpack_require__){var _ut=(__webpack_require__(5),__webpack_require__(2)),Dialog=(__webpack_require__(9),__webpack_require__(6),__webpack_require__(3),__webpack_require__(4),__webpack_require__(34),__webpack_require__(101)),d={};d.icons={alert:"icon-emotion",forbid:"icon-error",success:"icon-check-circle",fail:"icon-close-circle"},d.clazz={green:"succ",red:"fail"},d.createIconNode=function(type){return"noIcon"==type?"":"<i class='"+this.clazz["success"==type?"green":"red"]+" "+this.icons[type]+"'></i>"},d.iconDefault=function(icon){return icon||"success"},d.errorDefault=function(str){return str||"网络或系统错误"},d.okBtnDefault=function(str){return str||"确认"},d.ccBtnDefault=function(str){return str||"取消"},d.confirmDialog=function(text,btnText,icon,onok,onclose){new Dialog({data:{width:520,title:"提示",msg:"<p class='m-dialog-result'>"+d.createIconNode(d.iconDefault(icon))+text+"</p>",txtOk:d.okBtnDefault(btnText),hideCCBtn:!0,onok:function(){_ut._$isFunction(onok)&&onok()},onclose:function(){_ut._$isFunction(onclose)&&onclose()}}}).$inject(document.body)},d.errorDialog=function(text,btnText,onclose){d.confirmDialog(d.errorDefault(text),btnText,"fail",onclose,onclose)},d.autoCloseDialog=function(text,icon,onclose){new Dialog({data:{width:520,title:"提示",hideOkBtn:!0,hideCCBtn:!0,msg:"<p class='m-dialog-result'>"+d.createIconNode(d.iconDefault(icon))+text+"</p><p style='display:none;' countdown='2'></p>",onclose:function(){_ut._$isFunction(onclose)&&onclose()}._$bind(this)}}).$inject(document.body)},d.promptDialog=function(options){options=options||{},new Dialog({data:{width:520,title:"提示",msg:"<p class='m-dialog-result'>"+d.createIconNode(d.iconDefault(options.icon))+options.text+"</p>",txtOk:d.okBtnDefault(options.okBtnText),txtCC:d.ccBtnDefault(options.ccBtnText),onok:function(){_ut._$isFunction(options.onok)&&options.onok()},onclose:function(){_ut._$isFunction(options.onclose)&&options.onclose()},oncancel:function(){_ut._$isFunction(options.oncancel)&&options.oncancel()}}}).$inject(document.body)},d.twoLineDialog=function(options){options=options||{},new Dialog({data:{width:520,title:"提示",msg:'<div class="m-dialog-result f-tal '+(options.clazz||"")+'" style="margin-left:'+(options.marginLeft||0)+'px;">'+d.createIconNode(d.iconDefault(options.icon))+options.text1+'<p class="line2">'+options.text2+"</p></div>",txtOk:d.okBtnDefault(options.okBtnText),txtCC:d.ccBtnDefault(options.ccBtnText),hideOkBtn:!!options.hideOkBtn,hideCCBtn:!!options.hideCCBtn,onok:function(){_ut._$isFunction(options.onok)&&options.onok()},onclose:function(){_ut._$isFunction(options.onclose)&&options.onclose()}}}).$inject(document.body)},module.exports=d},774:function(module,exports,__webpack_require__){__webpack_require__(302),__webpack_require__(305),module.exports=__webpack_require__(14)},85:function(module,exports,__webpack_require__){var config=__webpack_require__(35),User=(__webpack_require__(5),__webpack_require__(2),__webpack_require__(9),__webpack_require__(3),__webpack_require__(4),__webpack_require__(34)),Request=__webpack_require__(12),Dialogs=__webpack_require__(74),j={};j.checkAccount=function(cb){this.commonGet("https://user.kaola.com/account/check.html",cb)},j.centerAuthOrModifyPhone=function(phone,cb){this.commonAjax(config.accountDomainUrl+"personal/account_management/update_phone",{phoneNum:phone},cb)},j.centerUpgradePhone=function(phone,cb){this.commonAjax(config.accountDomainUrl+"personal/account_management/upgrade_phone",{phoneNum:phone},cb)},j.centerVerifyPhone=function(bindToken,cb){this.commonAjax(config.accountDomainUrl+"personal/account_management/verify_phone",{bindingToken:bindToken},cb)},j.centerBindThirdparty=function(accountType,cb,win){this.commonAjax(config.accountDomainUrl+"personal/account_management/binding_thirdpart",{bindingAccountType:accountType},cb,win)},j.centerVerifyThirdparty=function(bindingToken,cb){this.commonAjax(config.accountDomainUrl+"personal/account_management/verify_thirdpart",{bindingToken:bindingToken},cb)},j.centerChooseMainAccount=function(data,cb){this.commonAjax(config.accountDomainUrl+"personal/account_management/choose_main_account",data,cb)},j.preBindAccount=function(data,cb,win){this.commonAjax(config.accountDomainUrl+"personal/preBindAccount",data,cb,win)},j.bindAccount=function(bindToken,cb){this.commonAjax(config.accountDomainUrl+"personal/bindAccount",{bindToken:bindToken},cb)},j.queryRelatedAccount=function(relatedAccountId,cb){this.commonAjax(config.accountDomainUrl+"personal/queryRelatedAccount",{relatedAccountId:relatedAccountId},cb)},j.setLoginCookie=function(bindToken,cb){this.commonAjax(config.accountDomainUrl+"personal/account_management/set_login_cookie",{bindingToken:bindToken},cb)},j.bindAccountForBusi=function(bindToken,cb){this.commonAjax(config.accountDomainUrl+"personal/bindAccountForBusi",{bindToken:bindToken},cb)},j.checkSource=function(data,cb){this.commonAjax(config.accountDomainUrl+"source/checkSource",data,cb)},j.commonGet=function(url,cb){Request(url,{norest:!0,method:"get",onload:function(_json){console.log("检查绑定手机号弹窗："+_json);var json=_json||{};json.data&&2===json.data.action?"function"==typeof cb&&cb("1"):"function"==typeof cb&&cb(!1)}._$bind(this),onerror:function(){"function"==typeof cb&&cb(!1)}})},j.commonAjax=function(url,data,onload,win){Request(url+".html",{norest:!0,method:"post",data:data,onload:function(_json){var json=_json||{};461===json.retcode?(User.afterLogin(function(){this.refreshPageDetail(),this.commonAjax(url,data,onload,win)}._$bind(this)),this.closeWin(win)):this.intoOnload(json,url)?"function"==typeof onload&&onload(json):(Dialogs.errorDialog(json.retdesc),this.closeWin(win))}._$bind(this),onerror:Dialogs.errorDialog._$bind(this,"","")})},j.intoOnload=function(json,url){return 200===json.retcode||-1!==url.indexOf("bindAccount")||-1!==url.indexOf("verify_phone")||-1!==url.indexOf("queryRelatedAccount")||-1!==url.indexOf("bindAccountForBusi")||-1!==url.indexOf("binding_thirdpart")&&-1===json.retcode||-1!==url.indexOf("verify_thirdpart")||-1!==url.indexOf("preBindAccount")&&-2===json.retcode||-1!==url.indexOf("update_phone")&&-2===json.retcode||-1!==url.indexOf("upgrade_phone")&&-2===json.retcode||-1!==url.indexOf("checkSource")},j.closeWin=function(win){win&&win.close()},j.refreshPageDetail=function(){window._$refreshPageDetail&&window._$refreshPageDetail()},module.exports=j}},[774]);
var _ACT_=_ACT_||{};_ACT_.components=_ACT_.components||{},_ACT_.components["pages/common/init"]=webpackJsonp([15],{313:function(module,exports,__webpack_require__){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _assign=__webpack_require__(8),_assign2=_interopRequireDefault(_assign),_baseComp=__webpack_require__(20),_baseComp2=_interopRequireDefault(_baseComp),_view=__webpack_require__(725),_view2=_interopRequireDefault(_view),_tools=__webpack_require__(1),ModuleList=_baseComp2.default.extend({template:_view2.default,config:function(data){var _this=this;(0,_assign2.default)(data,{defaultBgColor:"#f0f0f0",defaultTitleColor:"#333"}),data.configMap=data.configMap||{},this.$on("$inject",function(){_this.generateFenceImgInfo(data.moduleList||[]),window.addEventListener("resize",_tools.util.throttle(function(){_this.generateFenceImgInfo(data.moduleList||[])},100))}),_tools.eventEmitter.$on("updatemodulesdisplay",function(){var updateModuleList=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];_this.data.moduleList.forEach(function(){var module=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},hidden=!1;updateModuleList.some(function(){var updateModule=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};updateModule.id==module.id&&(hidden=!updateModule.display)}),module.hidden=hidden}),_this.$update()})},generateFenceImgInfo:function(){var _this2=this,moduleList=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],imgWrapWidth=document.body.clientWidth||window.innerWidth||0;moduleList.forEach(function(){var module=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},config=module.configMap||{};if(1==_this2.getFenceConfig(config,"fenceBgType")){var imageUrl=_this2.getFenceConfig(config,"fenceBgImg")||"",_ref=_tools.img.getSizeByImgUrl(imageUrl)||{},width=_ref.width,height=_ref.height,contentWidth=width>1e3?imgWrapWidth:1e3;module.fenceImgStyle={height:height+"px",width:contentWidth+"px","margin-left":-Math.max(0,contentWidth-1e3)/2+"px","background-size":width+"px "+height+"px","background-image":"url("+imageUrl+")","background-position":"center 0","background-repeat":"no-repat"}}}),this.$update()},getFenceConfig:function(){var config=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},name=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return name&&config?config.pcFenceConfig&&config.pcFenceConfig.hasOwnProperty(name)?config.pcFenceConfig[name]:config[name]:""},getFenceLink:function(){var config=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},extendMap=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,_tools.addTrackLink)({link:this.getFenceConfig(config,"fenceLink"),source:extendMap.source,pageId:extendMap.pageId,rIdForStatis:extendMap.rIdForStatis})},getFenceImgSizeInfo:function(){var config=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},imageUrl=this.getFenceConfig(config,"fenceBgImg")||"";return _tools.img.getSizeByImgUrl(imageUrl)||{}}});exports.default=ModuleList},314:function(module,exports,__webpack_require__){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _tools=__webpack_require__(1),_data=__webpack_require__(660),_data2=_interopRequireDefault(_data),_klass=__webpack_require__(661),_klass2=_interopRequireDefault(_klass),_wrap=__webpack_require__(662),_wrap2=_interopRequireDefault(_wrap),onCount=0,RegionShowModule={$show:function(){var _this=this,options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},isFirstScreen=options.isFirstScreen;_data2.default.$getData(options).then(function(regionDatas){_this.doBuildData(regionDatas),isFirstScreen&&regionDatas&&_tools.eventEmitter.$emit("firstScreenRegionLoaded",regionDatas.length)})},doBuildData:function(){var _this2=this,regionDatas=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],loadParams=[];regionDatas.forEach(function(regionData){var mIndex=regionData.extendMap.moduleIndex,regionObj=regionData.detailMap,id=regionObj.id,sortOrder=regionObj.sortOrder,regionType=regionObj.regionType,h5JsPath=regionObj.h5JsPath,pcJsPath=regionObj.pcJsPath,title=regionObj.title,wrapObj=_wrap2.default.$getWrap({mIndex:mIndex,sortOrder:sortOrder,regionType:regionType});if(!wrapObj||!wrapObj.wrap)return void console.warn("搭建配置错误: 组件类型:"+regionType+",组件id:"+id+", 渲染的节点为空! 请检查搭建系统对应模块的html代码设置!");var klassName=_klass2.default.$getKlassName({h5JsPath:h5JsPath,pcJsPath:pcJsPath,regionType:regionType}),klass=_klass2.default.$getKlass(klassName);klass?_this2.allocateRegion({regionData:regionData,klass:klass,wrapObj:wrapObj}):(console.warn("已加载的组件列表中未找到对应的组件对象：\r\n组件类名:'"+klassName+"'\r\n组件id:"+id+"\r\n组件type:"+regionType+"\r\n组件名称:"+title),loadParams.push({regionData:regionData,klassName:klassName,wrapObj:wrapObj}))}),loadParams.length>0&&(console.log("第 "+ ++onCount+" 次绑定"),_tools.eventEmitter.$on("regionJsLoaded",function(src){console.log(src+"加载完成！"),_this2.regionJSLoadedEvent(loadParams)}))},allocateRegion:function(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},regionData=options.regionData,klass=options.klass,_options$wrapObj=options.wrapObj,wrap=_options$wrapObj.wrap,pos=_options$wrapObj.pos,regionId=regionData.extendMap.regionId;regionId&&(wrap.setAttribute("data-regionid",regionId),regionData.isLoaded=!0,new klass({data:regionData}).$inject(wrap,pos||"")),_tools.eventEmitter.$emit("cbAllocateRegion",regionData)},regionJSLoadedEvent:function(){var _this3=this;(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(param){if(!param.regionData.isLoaded){var regionData=param.regionData,klassName=param.klassName,wrapObj=param.wrapObj,klass=_klass2.default.$getKlass(klassName);klass&&_this3.allocateRegion({regionData:regionData,klass:klass,wrapObj:wrapObj})}})}};exports.default=RegionShowModule},659:function(module,exports,__webpack_require__){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _assign=__webpack_require__(8),_assign2=_interopRequireDefault(_assign),_tools=__webpack_require__(1),_index=__webpack_require__(313),_index2=_interopRequireDefault(_index),_index3=__webpack_require__(314),_index4=_interopRequireDefault(_index3),_preview=__webpack_require__(99),_index5=__webpack_require__(10),_anticheat=__webpack_require__(73),_anticheat2=_interopRequireDefault(_anticheat);window.cbRegComboJsLoaded=function(src){_tools.eventEmitter.$emit("regionJsLoaded",src)},{showCount:5,isRegionNotValidCount:0,init:function(){window._ACT_=window._ACT_||{},window.cbLoadedInitData=this.cbLoadedInitData.bind(this)},cbLoadedInitData:function(){var _this=this,cbdata=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(cbdata&&cbdata.pageData&&cbdata.pageData.frameData&&cbdata.pageData.frameData.moduleList&&cbdata.pageData.frameData.moduleList.length>0){var _cbdata$pageData=cbdata.pageData,frameData=_cbdata$pageData.frameData,requestSource=_cbdata$pageData.requestSource,firstScreenUrl=cbdata.firstScreenUrl,redirectUrl=cbdata.redirectUrl,systemTime=cbdata.systemTime,scheduleTime=cbdata.scheduleTime,dynamicSwitch=cbdata.dynamicSwitch,anticheatToken=cbdata.anticheatToken,configMap=frameData.configMap,moduleList=frameData.moduleList,extraBtn=frameData.extraBtn,options={frameData:frameData,requestSource:requestSource,firstScreenUrl:firstScreenUrl,redirectUrl:redirectUrl,systemTime:systemTime,scheduleTime:scheduleTime,anticheatToken:anticheatToken,pageEntryType:extraBtn,dynamicSwitch:dynamicSwitch};return(0,_assign2.default)(window._ACT_,options),(moduleList||[]).forEach(function(){var module=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};module.configMap&&module.configMap.singleHiddenPc&&(module.hidden=!0)}),this.moduleList=moduleList,this.requestSource=requestSource,this.redirectUrl=redirectUrl,this.addEvent(),this.initModuleFrame(moduleList),this.initAllRegsParams(moduleList),_index5.user.$getUser().then(function(cbData){cbData&&(window.__vip=cbData.vip||!1),firstScreenUrl?(console.timeEnd("step2_render_frame"),console.time("step3_load_first_screen_region"),_this.onLoadFirstScreenRegion(firstScreenUrl)):_this.onLoadRegion(0)}).catch(function(){firstScreenUrl?(console.timeEnd("step2_render_frame"),console.time("step3_load_first_screen_region"),_this.onLoadFirstScreenRegion(firstScreenUrl)):_this.onLoadRegion(0)}),this.setShareConfig(configMap),this.lazyImgLoad(!0),this.initAnticheat(options),void this.previewDaPush()}location.href=_tools.browser.fixProtocol(cbdata.redirectUrl)},addEvent:function(){var _this2=this;_tools.eventEmitter.$on("frame_hideModuleTitle",this.hideModuleTitle.bind(this)),_tools.eventEmitter.$on("frame_updateModule",this.updateModule.bind(this)),_tools.eventEmitter.$on("firstScreenRegionLoaded",this.firstScreenRegionLoaded.bind(this)),_tools.eventEmitter.$on("isRegionNotValid",function(moduleIndex){_this2.isRedirect(),_this2.hideModuleTitle(moduleIndex)}),_tools.eventEmitter.$on("cbAllocateRegion",function(cbdata){var moduleIndex=cbdata.extendMap.moduleIndex;_this2.updateModule(moduleIndex,cbdata),_this2.lazyImgLoad(!1)})},initModuleFrame:function(){var moduleList=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];console.time("step2_render_frame"),this.moduleListComp=new _index2.default({data:{moduleList:moduleList}}).$inject("#j-box")},initAllRegsParams:function(moduleList){var _this3=this,regParams=[];moduleList.forEach(function(module,mIndex){if(1==_this3.requestSource&&2==module.allowType||2==_this3.requestSource&&1==module.allowType)return void console.error("后端错误: 模块ID为"+module.id+"的模块归属类型与浏览器的访问类型不匹配!需要后端检查模块过滤是否正确!");module.regionList.forEach(function(region,rIndex){regParams.push({mIndex:mIndex,rIndex:rIndex,moduleId:module.id,regionId:region.id,regionType:region.regionType,isDynamic:region.isDynamic||!1})})}),this.regParams=regParams},onLoadFirstScreenRegion:function(requestUrl){var options={requestUrl:requestUrl,regParams:this.regParams,isFirstScreen:!0};_index4.default.$show(options)},onLoadRegion:function(){var _this4=this,startIndex=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,endIndex=arguments[1],regParams=this.regParams;regParams=endIndex?regParams.slice(startIndex,endIndex):regParams.slice(startIndex);var length=regParams.length,options={isFirstScreen:!1},newRegParams=[];regParams.forEach(function(item,index){var shouldShow=!1,isDynamic=1==item.isDynamic;isDynamic||(newRegParams.push(item),newRegParams.length!=_this4.showCount&&index!=length-1||(shouldShow=!0)),shouldShow=shouldShow||isDynamic&&newRegParams.length>0,shouldShow&&(options.regParams=newRegParams,_index4.default.$show(options),newRegParams=[]),isDynamic&&(options.regParams=[item],_index4.default.$show(options),newRegParams=[])})},setShareConfig:function(){var configMap=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(configMap){var shareTitle=configMap.shareTitle,shareImgUrl=configMap.shareImgUrl,link=document.URL.split("?")[0]+"?from=appshare";window.shareConfig={img_url:_tools.browser.fixProtocol(shareImgUrl),link:link,desc:shareTitle,title:document.title,wbpost:shareTitle+">>"+link}}},hideModuleTitle:function(moduleIndex){var moduleData=this.moduleList[moduleIndex]||{};moduleData&&moduleData.configMap&&(moduleData.configMap.showFence&&(moduleData.configMap.showFence=!1),moduleData.configMap.pcFenceConfig&&moduleData.configMap.pcFenceConfig.showFence&&(moduleData.configMap.pcFenceConfig.showFence=!1),this.moduleListComp.$update())},updateModule:function(moduleIndex,extra){var moduleData=this.moduleList[moduleIndex]||{};moduleData&&!moduleData.loaded&&(moduleData.loaded=!0,moduleData.extendMap=extra&&extra.extendMap||{},this.moduleListComp.$update())},firstScreenRegionLoaded:function(startIndex){console.timeEnd("step3_load_first_screen_region"),console.time("step4_load_left_screen_regions"),this.onLoadRegion(startIndex),_tools.eventEmitter.$off("firstScreenRegionLoaded")},isRedirect:function(){++this.isRegionNotValidCount==this.regParams.length&&(location.href=this.redirectUrl)},lazyImgLoad:function(isInit){isInit?_tools.ImgLazyLoad.init({offset:100,throttle:_tools.browser.isIOS?10:50,unload:!1,callback:function(element,op){element.tagName&&"IMG"==element.tagName&&(element.className+=" u-"+op+"ed")}}):_tools.ImgLazyLoad.refresh()},initAnticheat:function(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_anticheat2.default.init({anstipamActiCheatSwitch:1,anstipamActiCheatToken:options.anticheatToken})},previewDaPush:function(){if(window.DATracker){var CUR_URL=location&&location.href,curUrlPrefix=(0,_preview.getPreviewPrefix)(CUR_URL);if(curUrlPrefix){var _ref=(0,_preview.getPreviewQs)(curUrlPrefix,CUR_URL)||{},definedUrl=_ref.definedUrl,email=_ref.email,scheduleTime=_ref.scheduleTime;if(!definedUrl||!email||!scheduleTime)return void console.warn("页面预览-参数错误：email="+email+", scheduleTime="+scheduleTime);window.DATracker.track("PagesPreview",{referID:document&&document.referrer||"",pageID:definedUrl,previewTime:scheduleTime,previewInnerID:email,userName:"",eventID:"PagesPreview",eventType:"view",viewTime:Date.now()})}}},destroy:function(){this.moduleList=null,this.regParams=null}}.init(),window._ej=window._ej||{},window._ej.push="function"===_tools.util.typeOf(window._ej.push)?window._ej.push:new Function},660:function(module,exports,__webpack_require__){Object.defineProperty(exports,"__esModule",{value:!0});var _assign=__webpack_require__(8),_assign2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_assign),_tools=__webpack_require__(1),_preview=__webpack_require__(99);window._ACT_=window._ACT_||{};var RegionDataModule={resetData:function(){var _ref=window._ACT_||{},frameData=_ref.frameData,requestSource=_ref.requestSource,scheduleTime=_ref.scheduleTime,dynamicSwitch=_ref.dynamicSwitch;this.frameData=frameData,this.requestSource=requestSource,this.scheduleTime=scheduleTime,this.dynamicSwitch=dynamicSwitch},$getData:function(options){this.frameData||this.resetData();var requestUrl=void 0;return requestUrl=options.requestUrl?options.requestUrl:this.getRequestUrl(options.regParams),this.getRequestData(requestUrl,options.regParams)},getRequestUrl:function(regParams){var _this=this,typeArr=[],idArr=[],dynamic=void 0;regParams.forEach(function(item){if(typeArr.push(item.regionType),idArr.push(item.regionId),!dynamic){var regionDetail=_this.$getDetailMap(item.mIndex,item.rIndex);dynamic=1===parseInt(regionDetail.isDynamic)}});var regionTypes=typeArr.join(","),regionIds=idArr.join(","),frameData=this.frameData,scheduleTime=this.scheduleTime,dynamicSwitch=this.dynamicSwitch,requestSource=this.requestSource,isDynamic=!!(dynamicSwitch||scheduleTime||dynamic),postfix=isDynamic?"html":"shtml";if(scheduleTime){var refer=_tools.browser.getParamInUrl("refer"),CUR_URL=location&&location.href,curUrlPrefix=(0,_preview.getPreviewPrefix)(CUR_URL);if(!curUrlPrefix)return;var _ref2=(0,_preview.getPreviewQs)(curUrlPrefix,CUR_URL)||{},definedUrl=_ref2.definedUrl,email=_ref2.email,query={definedUrl:definedUrl,email:email,requestSource:requestSource};return refer&&(query.refer=refer),"/pages/region/detail/preview/"+scheduleTime+"/"+frameData.id+"/"+regionTypes+"/"+regionIds+"."+postfix+"?"+_tools.util.obj2query(query)}return"/pages/region/detail/"+frameData.id+"/"+regionTypes+"/"+regionIds+"."+postfix+"?type=2"},getRequestData:function(requestUrl,params){var _this2=this;return _tools.fetchUtil.$request(requestUrl,{method:"GET"}).then(function(cbdata){return _this2.getRegDataList(cbdata.data||[],params)})},getRegDataList:function(){var _this3=this,regDataList=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],regParams=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],newRegDataList=[];return regDataList.forEach(function(){var regData=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},index=arguments[1],extendMap={},_ref3=regParams&&regParams[index]||{},mIndex=_ref3.mIndex,rIndex=_ref3.rIndex;(0,_assign2.default)(extendMap,{pageId:regData.pageId||"",regionId:regData.regionId||"",source:regData.source||"",rIdForStatis:regData.regionIdStr||"",moduleIndex:mIndex,regionIndex:rIndex}),newRegDataList.push({dataMap:regData.businessObj||{},detailMap:_this3.$getDetailMap(mIndex,rIndex),extendMap:extendMap,requestSource:_this3.requestSource})}),newRegDataList},$getDetailMap:function(mIndex,rIndex){var moduleList=this.frameData&&this.frameData.moduleList||[];return(moduleList[mIndex]&&moduleList[mIndex].regionList||[])[rIndex]||{}}};exports.default=RegionDataModule},661:function(module,exports){Object.defineProperty(exports,"__esModule",{value:!0}),window._ACT_=window._ACT_||{};var KlassModule={resetData:function(){this.requestSource=window._ACT_.requestSource},$getKlassName:function(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};void 0==this.requestSource&&this.resetData();var h5JsPath=options.h5JsPath,pcJsPath=options.pcJsPath,regionType=options.regionType,path=1==this.requestSource?h5JsPath:pcJsPath;if(!path)return console.error("后端错误或搭建脚本路径配置错误: 组件类型:"+regionType+"对应的脚本path为空!"),!1;var index=path.indexOf("components");return path.substring(index,path.length-3)},$getKlass:function(name){var klass=window._ACT_.components||{};return klass[name]&&klass[name].default}};exports.default=KlassModule},662:function(module,exports){Object.defineProperty(exports,"__esModule",{value:!0});var WrapModule={floorWraps:document.getElementsByClassName("j-floorflag"),$getWrap:function(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},mIndex=options.mIndex,sortOrder=options.sortOrder,regionType=options.regionType,floorWrap=this.floorWraps[mIndex],regionWraps=floorWrap.getElementsByClassName("j-regionflag")||[],regionWrapsArr=Array.prototype.slice.apply(regionWraps);return[30001,30002].indexOf(regionType)>-1?{pos:"after",wrap:floorWrap}:{wrap:regionWrapsArr.find(function(element){return(element.getAttribute("data-sortorder")||0)==sortOrder})}}};exports.default=WrapModule},725:function(module,exports){module.exports='{#if moduleList}\n{#list moduleList as x by x_index}\n<div id="module_{@(x.id)}" class="m-floor j-floorflag" data-moduleIndex="{@(x_index)}" data-moduleType="{@(x.moduleType)}" data-moduleId="{@(x.id)}" data-locateId="{@(x.locateId)}" style="margin-top:{@(x.configMap.topSpace||0)}px;background-color:{@(x.configMap.bgColor||defaultBgColor)}" r-hide={x.hidden}> {#if this.getFenceConfig(x.configMap, \'showFence\')} {#if x.moduleTitle && this.getFenceConfig(x.configMap, \'fenceBgType\') == 0} <div class="m-fenceTitle" style="{@( { \'color\': this.getFenceConfig(x.configMap, \'fenceTxtColor\') || defaultTitleColor, \'background-color\': this.getFenceConfig(x.configMap, \'fenceBgColor\') || \'transparent\' } | json2style )}">{@(x.moduleTitle)}</div> {#elseif this.getFenceConfig(x.configMap, \'fenceBgType\') == 1} <a target="_blank" class="f-tac f-db" href="{this.getFenceLink(x.configMap, x.extendMap)}" r-class={{\'f-csp\': !!this.getFenceConfig(x.configMap, \'fenceLink\')}} > <div r-style={x.fenceImgStyle}></div> </a> {/if} {/if} {#if !x.loaded}<div class="u-loading2"></div>{/if} <div r-html="{@(x.divTemplate||\'\')}"></div>\n</div>\n{/list}\n{/if}'}},[659]);